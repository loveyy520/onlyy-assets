!function(){function M(t,e){function n(){this.constructor=t}for(var r in e)Y.call(e,r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}var u,z,N,F,e,m,I,U,y,W,X,t,H,v,w,a,n,r,B,i,s,G,b,o,J,x,l,c,S,R,k,h,p,d,g,f,V,$,K,Q,C,T=[].slice,Y={}.hasOwnProperty,Z=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},tt={catchupTime:100,initialRate:.03,minTime:250,ghostTime:100,maxProgressPerFrame:20,easeFactor:1.25,startOnPageLoad:!0,restartOnPushState:!0,restartOnRequestAfter:500,target:"body",elements:{checkInterval:100,selectors:["body"]},eventLag:{minSamples:10,sampleCount:3,lagThreshold:3},ajax:{trackMethods:["GET"],trackWebSockets:!0,ignoreURLs:[]}},q=function(){var t;return null!=(t="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?t:+new Date},L=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,P=window.cancelAnimationFrame||window.mozCancelAnimationFrame;for(null==L&&(L=function(t){return setTimeout(t,50)},P=function(t){return clearTimeout(t)}),J=function(e){var n,r=q();return(n=function(){var t=q()-r;return 33<=t?(r=q(),e(t,function(){return L(n)})):setTimeout(n,33-t)})()},o=function(){var t=arguments[0],e=arguments[1],n=3<=arguments.length?T.call(arguments,2):[];return"function"==typeof t[e]?t[e].apply(t,n):t[e]},a=function(){for(var t,e,n,r=arguments[0],i=2<=arguments.length?T.call(arguments,1):[],s=0,o=i.length;s<o;s++)if(e=i[s])for(t in e)Y.call(e,t)&&(n=e[t],null!=r[t]&&"object"==typeof r[t]&&null!=n&&"object"==typeof n?a(r[t],n):r[t]=n);return r},H=function(t){for(var e,n,r=e=0,i=0,s=t.length;i<s;i++)n=t[i],r+=Math.abs(n),e++;return r/e},r=function(t,e){var n;if(null==t&&(t="options"),null==e&&(e=!0),n=document.querySelector("[data-pace-"+t+"]")){if(n=n.getAttribute("data-pace-"+t),!e)return n;try{return JSON.parse(n)}catch(t){return"undefined"!=typeof console&&null!==console?console.error("Error parsing inline pace options",t):void 0}}},_.prototype.on=function(t,e,n,r){var i;return null==r&&(r=!1),null==this.bindings&&(this.bindings={}),null==(i=this.bindings)[t]&&(i[t]=[]),this.bindings[t].push({handler:e,ctx:n,once:r})},_.prototype.once=function(t,e,n){return this.on(t,e,n,!0)},_.prototype.off=function(t,e){var n,r,i;if(null!=(null!=(r=this.bindings)?r[t]:void 0)){if(null==e)return delete this.bindings[t];for(n=0,i=[];n<this.bindings[t].length;)i.push(this.bindings[t][n].handler===e?this.bindings[t].splice(n,1):n++);return i}},_.prototype.trigger=function(){var t,e,n,r,i,s,o=arguments[0],a=2<=arguments.length?T.call(arguments,1):[];if(null!=(r=this.bindings)&&r[o]){for(n=0,s=[];n<this.bindings[o].length;)e=(i=this.bindings[o][n]).handler,t=i.ctx,i=i.once,e.apply(null!=t?t:this,a),s.push(i?this.bindings[o].splice(n,1):n++);return s}},C=_,m=window.Pace||{},window.Pace=m,a(m,C.prototype),b=m.options=a({},tt,window.paceOptions,r()),g=0,V=(K=["ajax","document","eventLag","elements"]).length;g<V;g++)!0===b[S=K[g]]&&(b[S]=tt[S]);function _(){}function et(t){this.source=t,this.last=this.sinceLastUpdate=0,this.rate=b.initialRate,this.catchup=0,this.progress=this.lastProgress=0,null!=this.source&&(this.progress=o(this.source,"progress"))}function nt(){var t,e,n=this;this.progress=null!=(e=this.states[document.readyState])?e:100,t=document.onreadystatechange,document.onreadystatechange=function(){return null!=n.states[document.readyState]&&(n.progress=n.states[document.readyState]),"function"==typeof t?t.apply(null,arguments):void 0}}function E(t){this.selector=t,this.progress=0,this.check()}function rt(){var t=this;this.elements=[],B().on("request",function(){return t.watch.apply(t,arguments)})}function D(){var e,i=this;D.__super__.constructor.apply(this,arguments),e=function(n){var r=n.open;return n.open=function(t,e){return c(t)&&i.trigger("request",{type:t,url:e,request:n}),r.apply(n,arguments)}},window.XMLHttpRequest=function(t){t=new d(t);return e(t),t};try{n(window.XMLHttpRequest,d)}catch(t){}if(null!=p){window.XDomainRequest=function(){var t=new p;return e(t),t};try{n(window.XDomainRequest,p)}catch(t){}}if(null!=h&&b.ajax.trackWebSockets){window.WebSocket=function(t,e){var n=null!=e?new h(t,e):new h(t);return c("socket")&&i.trigger("request",{type:"socket",url:t,protocols:e,request:n}),n};try{n(window.WebSocket,h)}catch(t){}}}function O(){this.bindings={}}function j(){this.progress=0}function A(){return A.__super__.constructor.apply(this,arguments)}C=Error,M(A,C),e=A,j.prototype.getElement=function(){var t;if(null==this.el){if(!(t=document.querySelector(b.target)))throw new e;this.el=document.createElement("div"),this.el.className="pace pace-active",document.body.className=document.body.className.replace(/pace-done/g,""),document.body.className+=" pace-running",this.el.innerHTML='<div class="pace-progress">\n  <div class="pace-progress-inner"></div>\n</div>\n<div class="pace-activity"></div>',null!=t.firstChild?t.insertBefore(this.el,t.firstChild):t.appendChild(this.el)}return this.el},j.prototype.finish=function(){var t=this.getElement();return t.className=t.className.replace("pace-active",""),t.className+=" pace-inactive",document.body.className=document.body.className.replace("pace-running",""),document.body.className+=" pace-done"},j.prototype.update=function(t){return this.progress=t,this.render()},j.prototype.destroy=function(){try{this.getElement().parentNode.removeChild(this.getElement())}catch(t){e=t}return this.el=void 0},j.prototype.render=function(){var t,e,n,r,i,s;if(null==document.querySelector(b.target))return!1;for(t=this.getElement(),n="translate3d("+this.progress+"%, 0, 0)",r=0,i=(s=["webkitTransform","msTransform","transform"]).length;r<i;r++)t.children[0].style[s[r]]=n;return(!this.lastRenderedProgress||this.lastRenderedProgress|0!==this.progress|0)&&(t.children[0].setAttribute("data-progress-text",(0|this.progress)+"%"),100<=this.progress?e="99":(e=this.progress<10?"0":"",e+=0|this.progress),t.children[0].setAttribute("data-progress",""+e)),this.lastRenderedProgress=this.progress},j.prototype.done=function(){return 100<=this.progress},z=j,O.prototype.trigger=function(t,e){var n,r,i,s,o;if(null!=this.bindings[t]){for(o=[],r=0,i=(s=this.bindings[t]).length;r<i;r++)n=s[r],o.push(n.call(this,e));return o}},O.prototype.on=function(t,e){var n;return null==(n=this.bindings)[t]&&(n[t]=[]),this.bindings[t].push(e)},r=O,d=window.XMLHttpRequest,p=window.XDomainRequest,h=window.WebSocket,n=function(t,e){var n,r=[];for(n in e.prototype)try{r.push(null==t[n]&&"function"!=typeof e[n]?"function"==typeof Object.defineProperty?Object.defineProperty(t,n,{get:function(){return e.prototype[n]},configurable:!0,enumerable:!0}):t[n]=e.prototype[n]:void 0)}catch(t){0}return r},s=[],m.ignore=function(){var t=arguments[0],e=2<=arguments.length?T.call(arguments,1):[];return s.unshift("ignore"),t=t.apply(null,e),s.shift(),t},m.track=function(){var t=arguments[0],e=2<=arguments.length?T.call(arguments,1):[];return s.unshift("track"),t=t.apply(null,e),s.shift(),t},c=function(t){if(null==t&&(t="GET"),"track"===s[0])return"force";if(!s.length&&b.ajax){if("socket"===t&&b.ajax.trackWebSockets)return!0;if(t=t.toUpperCase(),0<=Z.call(b.ajax.trackMethods,t))return!0}return!1},M(D,r),I=D,f=null,l=function(t){for(var e,n=b.ajax.ignoreURLs,r=0,i=n.length;r<i;r++)if("string"==typeof(e=n[r])){if(-1!==t.indexOf(e))return!0}else if(e.test(t))return!0;return!1},(B=function(){return f=null==f?new I:f})().on("request",function(t){var s,o=t.type,a=t.request,e=t.url;return l(e)||m.running||!1===b.restartOnRequestAfter&&"force"!==c(o)?void 0:(s=arguments,"boolean"==typeof(e=b.restartOnRequestAfter||0)&&(e=0),setTimeout(function(){var t,e,n,r,i;if("socket"===o?a.readyState<2:0<(n=a.readyState)&&n<4){for(m.restart(),i=[],t=0,e=(r=m.sources).length;t<e;t++){if((S=r[t])instanceof u){S.watch.apply(S,s);break}i.push(void 0)}return i}},e))}),rt.prototype.watch=function(t){var e=t.type,n=t.request,t=t.url;return l(t)?void 0:(t=new("socket"===e?W:X)(n),this.elements.push(t))},u=rt,X=function(e){var t,n,r,i,s=this;if(this.progress=0,null!=window.ProgressEvent)for(e.addEventListener("progress",function(t){return s.progress=t.lengthComputable?100*t.loaded/t.total:s.progress+(100-s.progress)/2},!1),t=0,n=(i=["load","abort","timeout","error"]).length;t<n;t++)e.addEventListener(i[t],function(){return s.progress=100},!1);else r=e.onreadystatechange,e.onreadystatechange=function(){var t;return 0===(t=e.readyState)||4===t?s.progress=100:3===e.readyState&&(s.progress=50),"function"==typeof r?r.apply(null,arguments):void 0}},W=function(t){for(var e,n=this,r=this.progress=0,i=(e=["error","open"]).length;r<i;r++)t.addEventListener(e[r],function(){return n.progress=100},!1)},C=function(t){var e,n,r,i;for(null==t&&(t={}),this.elements=[],null==t.selectors&&(t.selectors=[]),n=0,r=(i=t.selectors).length;n<r;n++)e=i[n],this.elements.push(new N(e))},E.prototype.check=function(){var t=this;return document.querySelector(this.selector)?this.done():setTimeout(function(){return t.check()},b.elements.checkInterval)},E.prototype.done=function(){return this.progress=100},N=E,nt.prototype.states={loading:0,interactive:50,complete:100},r=nt,F=function(){var e,n,r,i,s,o=this;this.progress=0,s=[],i=0,r=q(),n=setInterval(function(){var t=q()-r-50;return r=q(),s.push(t),s.length>b.eventLag.sampleCount&&s.shift(),e=H(s),++i>=b.eventLag.minSamples&&e<b.eventLag.lagThreshold?(o.progress=100,clearInterval(n)):o.progress=3/(e+3)*100},50)},et.prototype.tick=function(t,e){return 100<=(e=null==e?o(this.source,"progress"):e)&&(this.done=!0),e===this.last?this.sinceLastUpdate+=t:(this.sinceLastUpdate&&(this.rate=(e-this.last)/this.sinceLastUpdate),this.catchup=(e-this.progress)/b.catchupTime,this.sinceLastUpdate=0,this.last=e),e>this.progress&&(this.progress+=this.catchup*t),e=1-Math.pow(this.progress/100,b.easeFactor),this.progress+=e*this.rate*t,this.progress=Math.min(this.lastProgress+b.maxProgressPerFrame,this.progress),this.progress=Math.max(0,this.progress),this.progress=Math.min(100,this.progress),this.lastProgress=this.progress,this.progress},y=et,w=t=k=v=x=R=null,m.running=!1,i=function(){return b.restartOnPushState?m.restart():void 0},null!=window.history.pushState&&($=window.history.pushState,window.history.pushState=function(){return i(),$.apply(window.history,arguments)}),null!=window.history.replaceState&&(Q=window.history.replaceState,window.history.replaceState=function(){return i(),Q.apply(window.history,arguments)}),U={ajax:u,elements:C,document:r,eventLag:F},(G=function(){var t,e,n,r,i,s,o,a;for(m.sources=R=[],e=0,r=(s=["ajax","elements","document","eventLag"]).length;e<r;e++)!1!==b[t=s[e]]&&R.push(new U[t](b[t]));for(n=0,i=(a=null!=(o=b.extraSources)?o:[]).length;n<i;n++)S=a[n],R.push(new S(b));return m.bar=v=new z,x=[],k=new y})(),m.stop=function(){return m.trigger("stop"),m.running=!1,v.destroy(),w=!0,null!=t&&("function"==typeof P&&P(t),t=null),G()},m.restart=function(){return m.trigger("restart"),m.stop(),m.start()},m.go=function(){var f;return m.running=!0,v.render(),f=q(),w=!1,t=J(function(t,e){v.progress;for(var n,r,i,s,o,a,u,l,c,h=o=0,p=!0,d=a=0,g=R.length;a<g;d=++a)for(S=R[d],s=null!=x[d]?x[d]:x[d]=[],r=u=0,l=(n=null!=(c=S.elements)?c:[S]).length;u<l;r=++u)i=n[r],p&=(i=null!=s[r]?s[r]:s[r]=new y(i)).done,i.done||(h++,o+=i.tick(t));return v.update(k.tick(t,o/h)),v.done()||p||w?(v.update(100),m.trigger("done"),setTimeout(function(){return v.finish(),m.running=!1,m.trigger("hide")},Math.max(b.ghostTime,Math.max(b.minTime-(q()-f),0)))):e()})},m.start=function(t){a(b,t),m.running=!0;try{v.render()}catch(t){e=t}return document.querySelector(".pace")?(m.trigger("start"),m.go()):setTimeout(m.start,50)},"function"==typeof define&&define.amd?define(["pace"],function(){return m}):"object"==typeof exports?module.exports=m:b.startOnPageLoad&&m.start()}.call(this);const doc=document,body=doc.body,maxRainCount=20,maxRecycledCount=20,rain=()=>rainingPages.includes(location.pathname)&&(window.rain=new Rain),rainingPages=["/","/relax/music/","/zone/love-story/"];window.addEventListener("load",rain);class Rain{constructor(t){if(Rain.__instance)return Rain.__instance;this.init(t),this.run()}init(t){var{withVoice:t=!1,volume:e,generateDuration:n,dropDuration:r,initialSpeed:i,audioSrc:s,bgSrc:o}=t=t||Rain.defaultConfig;this.rains=[],this.recycledRains=[],this.maxRainCount=maxRainCount,this.maxRecycledCount=maxRecycledCount,this.dropTimer=this.rainTimer=null,this.volume=e||Rain.defaultConfig.volume,this.bgSrc=o||Rain.defaultConfig.bgSrc,this.generateDuration=n||Rain.defaultConfig.generateDuration,this.dropDuration=r||Rain.defaultConfig.dropDuration,this.initialSpeed=i||Rain.defaultConfig.initialSpeed,this.boxSize={},this.box=this.initContainer(),this.getSize(this.box,this.boxSize),window.onresize=()=>this.getSize(this.box,this.boxSize),t&&(this.audio=this.createAudio(s)),Rain.__instance=this}initContainer(){var e=doc.getElementById("rain-box");if(!e){(e=doc.createElement("div")).id="rain-box";let t="position: fixed;width: 100vw;height: 100vh;pointer-events: none; left:0; top:0; z-index:-1;";this.bgSrc&&(t+=`background: url(${this.bgSrc}) center/cover no-repeat;`),e.style.cssText=t,body.appendChild(e)}return e}getSize(t,e){e.height=t.clientHeight,e.width=t.clientWidth}random(t,e=1){return(Math.random()*t).toFixed(e)}initRainState=t=>{t.dataset.speed=this.initialSpeed,t.style.opacity=this.random(1),t.style.top=0,t.style.left=this.random(this.boxSize.width)+"px"};collectRain(){let t;this.recycledRains.length?t=this.recycledRains.shift():((t=doc.createElement("div")).style.cssText="position: absolute;width: 2px;height: 50px;background-image: linear-gradient(rgba(255, 255, 255, 0.3),rgba(255, 255, 255, 0.6));",this.box.appendChild(t)),this.initRainState(t),this.rains.push(t)}pruneRain(t){this.rains.splice(this.rains.indexOf(t),1),this.box.removeChild(t)}recycleRain(t){this.recycledRains.push(t),this.rains.splice(this.rains.indexOf(t),1)}createAudio=t=>{if(this.audio)return this.audio;const e=doc.createElement("audio");return e.autoplay=!1,e.style.display="none",e.volume=this.volume,e.loop="loop",t&&(e.src=t),this.box.appendChild(e),window.onclick=()=>e.play(),e};run(){this.generateRain(),this.fallDown()}generateRain(){this.rainTimer=setInterval(()=>{this.rains.length<=this.maxRainCount&&this.collectRain()},this.generateDuration)}fallDown(){this.dropTimer=setInterval(()=>{this.rains.forEach(t=>{var e=parseInt(t.dataset.speed),n=parseInt(t.style.top);if(n>=this.boxSize.height)return this.recycledRains.length>this.maxRecycledCount?this.pruneRain(t):this.recycleRain(t);t.style.top=n+e*this.dropDuration/10+"px",t.dataset.speed=e+1})},this.dropDuration)}mute(){this.audio.pause()}play(){this.audio.play()}update(t){this.init(t=t||{volume:.3,generateDuration:30,dropDuration:20,initialSpeed:3,audioSrc:"./rain.mp3",bgSrc:"./bg.png"})}unmount(){body.removeChild(this.box),this.box=null,this.audio=null,this.rains=this.recycledRains=[],clearInterval(this.dropTimer),clearInterval(this.rainTimer),Rain.__instance=null}static{this.__instance=null,this.defaultConfig={volume:.3,generateDuration:30,dropDuration:20,initialSpeed:3,audioSrc:"./rain.mp3",bgSrc:"./bg.png"}}}